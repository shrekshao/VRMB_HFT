!function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return e[r].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var r,a;r=[n(1),n(6),n(7)],a=function(e,t,n){window.AudioManager=e,window.imageLoader=t,window.imageUtils=n}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;"use strict",r=[n(2),n(5)],a=function(e,t){var n=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,r=function(r,a){function i(e,t,n,r){this.name=e;var a=this,i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){s.decodeAudioData(i.response,function(e){a.buffer=e,r&&r(!1)},function(){console.error("failed to decoding audio buffer: "+t),r&&r(!0)})},i.addEventListener("error",function(e){console.error("failed to load:",t," : ",e.target.status)},!1),i.send()}function o(e,t,n,r){this.waiting_on_load=n,this.samples=n||1,this.name=e,this.play_idx=0,this.audio={};for(var a=0;n>a;a++){var i=new Audio,o=this,s=function(e){o.waiting_on_load--,r&&r(e)};i.addEventListener("canplaythrough",function(){s(!1)},!1),i.src=t,i.onerror=function(){s(!0)},i.load(),this.audio[a]=i}}a=a||{};var s,u,c,f,h,d,l,v=new t,p={},m=!1,g=function(e,t){return e.substring(0,e.length-3)+t};this.needUserGesture=function(){var e=!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g),t=e;return function(){return t}}(),this.on=v.on.bind(v),this.addListener=this.on,this.addEventListener=this.on,this.removeListener=v.removeListener.bind(v),this.removeEventListener=this.removeListener,a.callback&&(console.warn("AudioManager: options.callback is deprecated. Use mgr.on('loaded', ...)"),this.on("loaded",a.callback)),a.startedOnTouchCallback&&(console.warn("AudioManager: options.startedOnTouchCallback is deprecated. Use mgr.on('started', ...)"),this.on("started",a.callback));var y=function(){};y.prototype.play=function(e,t){if(!this.buffer)return console.log(this.name," not loaded"),void 0;var n=s.createBufferSource();return n.buffer=this.buffer,n.loop=t||!1,n.connect(s.destination),n.start?n.start(e||0):n.noteOn(e||0),n};var w=function(t,n,r,a){this.buffer=e.createAudioBuffer(s,n),a&&setTimeout(a,0)};w.prototype=new y,i.prototype=new y;var S=function(t,n,r,a){this.samples=r||1,this.audio={},this.playNdx=0;for(var i=0;r>i;++i)this.audio[i]=e.createWave(n);a&&setTimeout(a,0)};S.prototype.play=function(e,t){this.playNdx=(this.playNdx+1)%this.samples;var n=this.audio[this.playNdx],r=new Audio;r.src=n.src,r.addEventListener("canplaythrough",function(){r.play()},!1),r.load()},o.prototype.play=function(e,t){if(this.waiting_on_load>0)return console.log(this.name," not loaded"),void 0;this.play_idx=(this.play_idx+1)%this.samples;var n=this.audio[this.play_idx],r=new Audio;r.src=n.src,r.addEventListener("canplaythrough",function(){r.play()},!1),r.load()};this.playSound=function(e,t,n){if(m){var r=p[e];return r?r.play(t,n):(console.error("audio: '"+e+"' not known."),void 0)}}.bind(this),this.getTime=function(){return s?s.currentTime:.001*Date.now()}.bind(this);var b=function(){if(this.needUserGesture())for(var e=0,t=window,n=["touchstart","mousedown"],r=function(){if(++e,3>e){var a=s.createOscillator(),i=s.createGain();a.frequency.value=1,a.connect(i),i.gain.value=0,i.connect(s.destination),a.start?a.start(0):a.noteOn(0),setTimeout(function(){a.disconnect()},100)}if(3==e){for(var o=0;o<n.length;++o)t.removeEventListener(n[o],r,!1);v.emit("started")}},a=0;a<n.length;++a)t.addEventListener(n[a],r,!1)}.bind(this);this.loadSound=function(e,t,n,r){var a=t.substring(t.length-3);"ogg"!=a||u?"mp3"!=a||c||(t=g(t,"ogg")):t=g(t,"mp3");var i=new d(e,t,n,r);return p[e]=i,i}.bind(this),this.makeJSFXSound=function(e,t,n,r){var a=new l(e,t,n,r);return p[e]=a,a}.bind(this),this.init=function(e){var t=new Audio;if(u=t.canPlayType("audio/ogg"),c=t.canPlayType("audio/mp3"),f=t.canPlayType("audio/wav"),h=t.canPlayType("audio/aif")||t.canPlayType("audio/aiff"),m=u||c,m){n?(console.log("Using Web Audio API"),s=new n,s.createGain||(s.createGain=s.createGainNode.bind(s)),d=i,l=w):(console.log("Using Audio Tag"),d=o,l=S);var r=1,a=function(){--r,0==r&&v.emit("loaded")};e&&Object.keys(e).forEach(function(t){var n=e[t];++r,n.jsfx?this.makeJSFXSound(t,n.jsfx,n.samples,a):this.loadSound(t,n.filename,n.samples,a)}.bind(this)),setTimeout(a,0),n&&b()}}.bind(this),this.init(r),this.getSoundIds=function(){return Object.keys(p)}};return r.hasWebAudio=function(){return void 0!==n},r}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;"use strict",r=[n(3),n(4)],a=function(e,t){var n={};return function(){this.createWaves=function(e){var t={};for(var n in e){var r=e[n];t[n]=this.createWave(r)}return t},this.createWave=function(n){var r=this.arrayToParams(n),a=t.generate(r),i=e.make(a);return i},this.createAudioBuffers=function(e,t){var n={};for(var r in t){var a=t[r];n[r]=this.createAudioBuffer(e,a)}return n},this.createAudioBuffer=function(n,r){var a=this.arrayToParams(r),i=t.generate(a),o=e.makeAudioBuffer(n,i);return o},this.paramsToArray=function(e){for(var n=[],r=t.Parameters.length,a=0;r>a;a++)n.push(e[t.Parameters[a].id]);return n},this.arrayToParams=function(e){for(var n={},r=t.Parameters.length,a=0;r>a;a++)n[t.Parameters[a].id]=e[a];return n}}.apply(n),n}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r;"use strict",r=function(){var e={};return function(e){this.SampleRate=e||44100;var t=this.SampleRate,n=16,r=1,a=r*n>>3,i=t*a,o=String.fromCharCode,s="data:audio/wav;base64,",u=function(e){var o;return d(["RIFF",36+(o=e.length),"WAVEfmt ",16,1,r,t,i,a,n,"data",o,e],"s4s4224422s4s")};this.make=function(e){return new Audio(s+btoa(u(w(e))))},this.makeWaveFile=function(e){l(s+btoa(u(w(e))))},this.makeAudioBuffer=function(e,n){for(var r=e.createBuffer(1,n.length,t),a=r.getChannelData(0),i=0;i<n.length;++i)a[i]=n[i];return r};var c,f,h=function(e,t){var n=255;return t?o(e&n)+h(e>>8,t-1):""},d=function(e,t){var n="";for(f=0;f<e.length;f++)n+="s"==t[f]?e[f]:h(e[f],t.charCodeAt(f)-48);return n},l=function(e){document.location.href=e},v=Math.sin,p=2*Math.PI,m=function(e){return new Array(0|e)};this.toTime=function(e){return e/t},this.toSamples=function(e){return e*t};var g=function(e){var t="",n=e.length;for(f=0;n>f;f++){var r=32767*e[f]|0;r=-32768>r?-32768:r>32767?32767:r,r+=0>r?65536:0,t+=String.fromCharCode(255&r,r>>8)}return t},y=function(e){var t="",n=e.length;for(f=0;n>f;f++){var r=127*e[f]+128|0;r=0>r?0:r>255?255:r,t+=String.fromCharCode(r)}return t},w=function(e){return 16==n?g(e):y(e)};this.adjustVolume=function(e,t){for(f=0;f<e.length;f++)e[f]*=t;return e},this.filter=function(e,t,n,r,a,i,o,s,u,h){for(n=n?n:1,r=r?r:e.length,c=e.slice(0),f=n;r>f;f++)c[f]=t(e,c,n,r,f,a,i,o,s,u,h);return c};var S=this.filter;this.filters={lowpass:function(e,t,n,r,a,i){return t[a-1]+i*(e[a]-t[a-1])},lowpassx:function(e,t,n,r,a,i){return t[a-1]+i*(r-a)/(r-n)*(e[a]-t[a-1])},highpass:function(e,t,n,r,a,i){return i*(t[a-1]+e[a]-e[a-1])}};var b=this.filters;this.f={lowpass:function(e,t,n,r){return S(e,b.lowpass,t,n,r)},lowpassx:function(e,t,n,r){return S(e,b.lowpassx,t,n,r)},highpass:function(e,t,n,r){return S(e,b.highpass,t,n,r)}},this.generate=function(e,n,r,a,i,o,s,u,c){var h=n*p/t,d=m(e);for(f=0;e>f;f++)d[f]=r(f*h,a,i,o,s,u,c);return d};var x=0,C=this.generate;this.generators={noise:function(e){return 4>e%p&&(x=2*Math.random()-1),x},uninoise:Math.random,sine:Math.sin,synth:function(e){return v(e)+.5*v(e/2)+.3*v(e/4)},saw:function(e){return 2*(e/p-(e/p+.5|0))},square:function(e,t){return v(e)>t?1:v(e)<t?-1:t}};var A=this.generators;this.g={noise:function(e){return C(e,0,A.noise)},sine:function(e,t){return C(e,t,A.sine)},synth:function(e,t){return C(e,t,A.synth)},saw:function(e,t){return C(e,t,A.saw)},square:function(e,t,n){return C(e,t,A.square,n)}}}.apply(e),e}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))},function(e,t,n){var r,a;"use strict",r=[n(3)],a=function(e){var t={};return function(){this.Parameters=[],this.Generators={square:e.generators.square,saw:e.generators.saw,sine:e.generators.sine,noise:e.generators.noise,synth:e.generators.synth},this.getGeneratorNames=function(){var e=[];for(var t in this.Generators)e.push(t);return e};var n=function(e){return e.replace(/ /g,"")};this.getParameters=function(){var e=[],t=0,r=function(r,a,i,o,s){void 0===s&&(s=(i-a)/1e3);var u={name:r,id:n(r),min:a,max:i,step:s,def:o,type:"range",group:t};e.push(u)},a=function(r,a,i){var o={name:r,id:n(r),options:a,def:i,type:"option",group:t};e.push(o)},i=this.getGeneratorNames();return a("Generator",i,i[0]),r("Super Sampling Quality",0,16,0,1),r("Master Volume",0,1,.4),t++,r("Attack Time",0,1,.1),r("Sustain Time",0,2,.3),r("Sustain Punch",0,3,2),r("Decay Time",0,2,1),t++,r("Min Frequency",20,2400,0,1),r("Start Frequency",20,2400,440,1),r("Max Frequency",20,2400,2e3,1),r("Slide",-1,1,0),r("Delta Slide",-1,1,0),t++,r("Vibrato Depth",0,1,0),r("Vibrato Frequency",.01,48,8),r("Vibrato Depth Slide",-.3,1,0),r("Vibrato Frequency Slide",-1,1,0),t++,r("Change Amount",-1,1,0),r("Change Speed",0,1,.1),t++,r("Square Duty",0,.5,0),r("Square Duty Sweep",-1,1,0),t++,r("Repeat Speed",0,.8,0),t++,r("Phaser Offset",-1,1,0),r("Phaser Sweep",-1,1,0),t++,r("LP Filter Cutoff",0,1,1),r("LP Filter Cutoff Sweep",-1,1,0),r("LP Filter Resonance",0,1,0),r("HP Filter Cutoff",0,1,0),r("HP Filter Cutoff Sweep",-1,1,0),e},this.generate=function(n){var r=2*Math.PI,a=Math.sin,i=(Math.cos,Math.pow),o=Math.abs,s=e.SampleRate,u=0|n.SuperSamplingQuality;1>u&&(u=1),s*=u;for(var c=1+n.SustainPunch,f=[{from:0,to:1,time:n.AttackTime},{from:c,to:1,time:n.SustainTime},{from:1,to:0,time:n.DecayTime}],h=f.length,d=0;h>d;d++)f[d].samples=1+(f[d].time*s|0);for(var l=void 0,v=0,p=-1,m=0,g=-1,y=0,d=0;h>d;d++)y+=f[d].samples;s/2>y&&(y=s/2);var w=y/u|0,S=new Array(w),b=0,x=0,C=t.Generators[n.Generator];void 0===C&&(C=this.Generators.square);var A=0,F=0;A=n.SquareDuty;var P=n.SquareDutySweep/s,T=0,M=n.StartFrequency*r/s,k=1+64*i(n.Slide,3)/s,q=i(n.DeltaSlide,3)/(1e3*s);void 0!==u&&(q/=u),n.MinFrequency>n.StartFrequency&&(n.MinFrequency=n.StartFrequency),n.MaxFrequency<n.StartFrequency&&(n.MaxFrequency=n.StartFrequency);var L=n.MinFrequency*r/s,D=n.MaxFrequency*r/s,R=0,E=n.VibratoFrequency*r/s,I=n.VibratoDepth,G=1+3*i(n.VibratoFrequencySlide,3)/s,B=n.VibratoDepthSlide/s,H=0,O=n.ChangeSpeed*s,V=i(n.ChangeAmount,2);V=n.ChangeAmount>0?1+10*V:1-.9*V;for(var W=1024,_=1023,j=new Array(W),N=0;W>N;N++)j[N]=0;var U=0,X=i(n.PhaserOffset,2)*(W-4),J=4e3*i(n.PhaserSweep,3)/s,Q=o(J)>1e-5||o(X)>1e-5,z=n.HPFilterCutoff>.001||n.LPFilterCutoff<.999,K=0,Y=0,Z=i(n.LPFilterCutoff,3)/10,$=1+n.HPFilterCutoffSweep/1e4,ee=5/(1+20*i(n.LPFilterResonance,2))*(.01+n.LPFilterCutoff);ee>.8&&(ee=.8),ee=1-ee;var te=n.LPFilterCutoff<.999,ne=0,re=i(n.HPFilterCutoff,2)/10,ae=1+n.HPFilterCutoffSweep/1e4,ie=0,oe=y;n.RepeatSpeed>0&&(oe=i(1-n.RepeatSpeed,2)*s+32);for(var se=n.MasterVolume,ue=0,d=0;y>d;d++){b=C(T,A,F),A+=P,0>A?A=0:A>.5&&(A=.5),ie>oe&&(T=0,M=n.StartFrequency*r/s,k=1+3*i(n.Slide,3)/s,q=i(n.DeltaSlide,3)/(1e3*s),void 0!==u&&(q/=u),H=0,O=n.ChangeSpeed*s,V=1+(0|n.ChangeAmount)/12,ie=0),ie+=1,T+=M,k+=q,M*=k,H>O&&(M*=V,O=y),H+=1,M>D?M=D:L>M&&(M=L),R+=E;var ce=M*a(R)*I;if(T+=ce,E*=G,B&&(I+=B,0>I?(I=0,B=0):I>1&&(I=1,B=0)),z){o(re)>.001&&(re*=ae,1e-5>re?re=1e-5:re>.1&&(re=.1));var fe=K;Z*=$,0>Z?Z=0:Z>.1&&(Z=.1),te?(Y+=(b-K)*Z,Y*=ee):(K=b,Y=0),K+=Y,ne+=K-fe,ne*=1-re,b=ne}if(Q){X+=J,0>X&&(X=-X,J=-J),X>_&&(X=_,J=0),j[U]=b;var he=U-(0|X)+W&_;b+=j[he],U=U+1&_}d>g&&(p+=1,l=h>p?f[p]:{from:0,to:0,samples:y},v=l.from,m=(l.to-l.from)/(l.samples+1),g+=l.samples),b*=v,v+=m,b*=se,u>1?(x+=b,(d+1)%u===0&&(S[ue]=x/u,ue+=1,x=0)):S[d]=b}for(var de=s/100|0,le=new Array(de),d=0;de>d;d++)le[d]=0;return le.concat(S).concat(le)},this.Parameters=this.getParameters()}.apply(t),t}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;"use strict",r=[],a=function(){var e=function(){var e={},t=10,n=function(e){t=e},r=function(n,r){if(!r)return delete e[n],void 0;var a=e[n];a||(a=[],e[n]=a),a.push(r),a.length>t&&console.warn("More than "+t+" added to event "+n)},a=function(t,n){if(!n)return delete e[t],void 0;var r=e[t];if(r){var a=r.indexOf(n);a>=0&&r.splice(a,1)}},i=function(){e={}},o=function(t){var n=e[t];if(n){var r=Array.prototype.slice.call(arguments,1);n.forEach(function(e){e.apply(this,r)})}},s=function(t){return e[t]};this.on=r,this.addEventListener=r,this.removeEventListener=a,this.removeAllEventListeners=i,this.addListener=r,this.removeListener=a,this.removeAllListeners=i,this.emit=o,this.listeners=s,this.setMaxListeners=n};return e}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r;"use strict",r=function(){var e=function(e,t){var n=new Image;return n.onload=t,n.src=e,n},t=function(t,n){var r=0;Object.keys(t).forEach(function(a){r++,t[a].img=e(t[a].url,function(){r--,0==r&&n()})})};return{loadImage:e,loadImages:t}}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))},function(e,t,n){var r,a;"use strict",r=[n(8)],a=function(e){var t=function(t,n,r,a,i){i=i||[0,1];var o=(i[0]+0)%1,s=(i[1]+0)%1,u=function(e){return e>=o&&s>=e},c=function(e){return e>=o||s>=e},f=s>o?u:c,h=document.createElement("canvas"),d=t.width,l=t.height;h.width=d,h.height=l;var v=h.getContext("2d");v.drawImage(t,0,0);for(var p=v.getImageData(0,0,d,l),m=p.data,g=d*l,y=4*g,w=0;y>w;w+=4){var S=e.rgb255ToHsv(m[w+0],m[w+1],m[w+2]);if(f(S[0])){var b=(S[0]+n+100)%1,x=Math.min(1,Math.max(0,S[1]+r)),C=Math.min(1,Math.max(0,S[2]+a)),A=e.hsvToRgb255(b,x,C);m[w+0]=A[0],m[w+1]=A[1],m[w+2]=A[2]}}return v.putImageData(p,0,0),h},n=function(e,t,n,r,a){var i=document.createElement("canvas");i.width=r,i.height=a;var o=i.getContext("2d");return o.drawImage(e,t,n,r,a,0,0,r,a),i},r=function(e,t,n){var r=document.createElement("canvas");r.width=e.width,r.height=e.height;var a=r.getContext("2d");a.drawImage(e,0,0);var i=a.getImageData(0,0,r.width,r.height),o=i.data;r.width=t,r.height=n;for(var s=a.createImageData(t,n),u=s.data,c=0;n>c;++c)for(var f=c*e.height/n|0,h=c*t*4,d=0;t>d;++d){var l=d*e.width/t|0,v=4*(f*e.width+l);u[h++]=o[v++],u[h++]=o[v++],u[h++]=o[v++],u[h++]=o[v++]}return a.putImageData(s,0,0),r},a=function(e,t){t.font&&(e.font=t.font),t.fillStyle&&(e.fillStyle=t.fillStyle),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaselne)},i=function(e,t,n){var r=n||document.createElement("canvas"),i=r.getContext("2d");i.save(),a(i,t);var o=i.measureText(e),s=o.width+(t.padding||0);t.maxWidth&&(s=Math.min(s,t.maxWidth)),t.minWidth&&(s=Math.max(s,t.minWidth));var u=t.padding||0;return r.width=s+2*u,r.height=t.height+2*u,t.prepFn?t.prepFn(i):t.backgroundColor?(i.fillStyle=t.backgroundColor,i.fillRect(0,0,i.canvas.width,i.canvas.height)):i.clearRect(0,0,i.canvas.width,i.canvas.height),a(i,t),i.fillText(e,(t.xOffset||0)+u,(t.yOffset||0)+u),i.restore(),r};return{adjustHSV:t,cropImage:n,hsvToRgb:e.hsvToRgb255,makeTextImage:i,rgbToHsv:e.rgb255ToHsv,scaleImage:r}}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;"use strict",r=[],a=function(){var e=function(e,t,n){var r,a,i=Math.max(e,t,n),o=Math.min(e,t,n),s=i,u=i-o;if(a=0==i?0:u/i,i==o)r=0;else{switch(i){case e:r=(t-n)/u+(n>t?6:0);break;case t:r=(n-e)/u+2;break;case n:r=(e-t)/u+4}r/=6}return[r,a,s]},t=function(t,n,r){return e(t/255,n/255,r/255)},n=function(e,t,n){var r,a,i,o=Math.floor(6*e),s=6*e-o,u=n*(1-t),c=n*(1-s*t),f=n*(1-(1-s)*t);switch(o%6){case 0:r=n,a=f,i=u;break;case 1:r=c,a=n,i=u;break;case 2:r=u,a=n,i=f;break;case 3:r=u,a=c,i=n;break;case 4:r=f,a=u,i=n;break;case 5:r=n,a=u,i=c}return[r,a,i]},r=function(e,t,r){var a=n(e,t,r);return[255*a[0]|0,255*a[1]|0,255*a[2]|0]},a=function(e,t,n){return.2126*e+.7152*t+.0722*n},i=function(e,t,n){return a(e/255,t/255,n/255)},o=function(e){return u(e[0],e[1],e[2],e[3])},s=function(e){return c(e[0],e[1],e[2],e[3])},u=function(e,t,n,r){return void 0===r&&(r=1),c(255*e|0,255*t|0,255*n|0,255*r|0)},c=function(e,t,n,r){return void 0===r&&(r=255),"rgba("+e+","+t+","+n+","+r/255+")"};return{hsvToRgb01:n,hsvToRgb255:r,makeCSSColorFromRgba01:u,makeCSSColorFromRgba255:c,makeCSSColorFromRgba01Array:o,makeCSSColorFromRgba255Array:s,rgb01Brightness:a,rgb01ToHsv:e,rgb255Brightness:i,rgb255ToHsv:t}}.apply(t,r),!(void 0!==a&&(e.exports=a))}]);